<include file="../public/header_dialog" />
{$usejs}

<div class="so_main">

  <div class="page_tit">消息推送管理</div>
  <div class="tit_tab">
	<ul>
		<li><a class=on href="#">修改Android消息推送</a></li>
	</ul>
  </div>

<table border="0" cellspacing="0" cellpadding="0" style="width:900px;">
<tr>
<td>
<!--/dialog_start-->

<form method="post" id="act_form" name="act_form" action="{:U('admin/push_message/push_message_edit_action')}" enctype="multipart/form-data">
	<table class="add_table" border="0" cellspacing="0" cellpadding="0" >
		<tbody>
				<tr>
					<th>消息编号：</th>
					<td>{$data.message_number}</td>
				</tr>
				<tr>
					<th>球场UID：</th>
					<td><input type="text" name="field_uid" id="field_uid" class="mod_input2" style="width:300px;"  value="{$data.field_uid}"></td>
				</tr>
				<tr>
					<th>推送平台：</th>
					<td>
						<select name="message_type"  style="width:100px;">
							<option value="">请选择</option>
							<option value="android">android</option>
							<option value="ios">ios</option>
						</select>
						<script>set_select_value(document.act_form.message_type,"{$data.message_type}");</script>
					</td>
				</tr>
				<tr>
					<th>发送范围：</th>
					<td>
						<select name="receiver_type" style="width:100px;" onchange="load_type_info(this.value);">
							<option value="">请选择</option>
							<option value="4">所有用户</option>
							<option value="3">指定用户</option>
						</select>
						<script>set_select_value(document.act_form.receiver_type,"{$data.receiver_type}");</script>
					</td>
				</tr>
				<tr>
					<th>消息标题：</th>
					<td><input type="text" name="message_title" id="message_title" class="mod_input2" style="width:300px;"  value="{$data.message_title}"></td>
				</tr>
				<tr>
					<th>消息内容：</th>
					<td><textarea name="n_content" id="n_content" class="mod_input2" style="width:400px; height:100px;">{$data.n_content}</textarea></td>
				</tr>

				</tbody>
				</table>

				<table class="add_table" border="0" cellspacing="0" cellpadding="0" id="type_3" <php>if($data['receiver_type']=="3"){ echo " style='display:block;' ";}else { echo " style='display:none;' ";}</php> >
				<tr>
					<th>目标用户：</th>
					<td><input type="text" name="uid" id="uid" class="mod_input2" style="width:100px;"  value="{$data.uid}"></td>
				</tr>
				</table>

				<table class="add_table" border="0" cellspacing="0" cellpadding="0"  id="type_4" <php>if($data['receiver_type']=="4"){ echo " style='display:block;' ";}else { echo " style='display:none;' ";}</php>>
				<tr>
					<th>扩展信息：</th>
					<td>
						<select name="ext_action" style="width:100px;">
							<option value="">请选择</option>
							<option value="event_list">赛事列表</option>
							<option value="wap">WAP</option>
							<option value="apply_ticket">门票申请</option>
							<option value="bmw_apply">门票报名</option>
							<option value="mathcenter">赛事直播</option>
							<option value="blog_detail">博客详细页</option>
							<option value="app_store">APP STORE</option>
							<option value="golf_forum_list">高球论坛列表</option>
							<option value="golf_forum_detail">高球论坛详细页</option>
							<option value="album_list">图片库</option>
							<option value="album_detail">图片库详细页</option>
						</select>
						<script>set_select_value(document.act_form.ext_action,"{$data.ext_action}");</script>
					</td>
				</tr>
				<tr>
					<th></th>
					<td>
						<input type="text" name="ext_id" id="ext_id" class="mod_input2" style="width:100px;"  value="{$data.ext_id}">（相应ID：赛事直播sid   /  博客blogid / 论坛详细event_id / 图片库详细 album_id）
					</td>
				</tr>
				<tr>
					<th></th>
					<td>

						<input type="text" name="ext_title" id="ext_title" class="mod_input2" style="width:100px;"  value="{$data.ext_title}">（相应TITLE，当扩展信息为WAP是此处填写wap地址）
					
					</td>
				</tr>
				</table>

				<table class="add_table" border="0" cellspacing="0" cellpadding="0" >

				<tr>
					<th>消息状态：</th>
					<td><input type="text" name="message_state" id="message_state" class="mod_input2" style="width:66px;"  value="{$data.message_state}"></td>
				</tr>
				
				<tr>
					<th>共需发送：</th>
					<td><input type="text" name="message_totalnum" id="message_totalnum" class="mod_input2" style="width:66px;"  value="{$data.message_totalnum}"></td>
				</tr>
				<tr>
					<th>总发送数：</th>
					<td><input type="text" name="message_sendnum" id="message_sendnum" class="mod_input2" style="width:66px;"  value="{$data.message_sendnum}"></td>
				</tr>
				<tr>
					<th>错误代码：</th>
					<td><input type="text" name="message_errorcode" id="message_errorcode" class="mod_input2" style="width:300px;"  value="{$data.message_errorcode}"></td>
				</tr>
				<tr>
					<th>错误信息：</th>
					<td><input type="text" name="message_errormsg" id="message_errormsg" class="mod_input2" style="width:300px;"  value="{$data.message_errormsg}"></td>
				</tr>
				<tr>
					<th>发送时间：</th>
					<td><input type="text" name="message_sendtime" id="message_sendtime" readonly class="mod_input_date" style="width:200px;" value="{$data.message_sendtime|format_to_time}" onFocus="WdatePicker({isShowClear:false,readOnly:true})" ></td>
				</tr>
				
		</tbody>
		<tfoot>
			<tr>
				<th></th>
				<td>
					<input type="hidden" name="message_id" value="{$data.message_id}">
					<input type="submit" class="btn_b" value="保存" style="margin-right:10px;"/>
					<input type="button" class="btn_w" onclick="close_dialog(this)" value="取消" />
				</td>
		</tfoot>
	</table><!--/add_table-->
</form>



<script>
$(document).ready(function(){
$.formValidator.initConfig({formID:"act_form",theme:'ArrowSolidBox',mode:'AutoTip',onError:function(msg){msg_error(msg)},inIframe:true});

	$("#message_number").formValidator({empty:true,onShow:"请输入消息编号",onFocus:"请输入消息编号",onCorrect:"输入正确"}).inputValidator({min:1,max:50,onError:"请输入消息编号"});
		$("#message_type").formValidator({empty:true,onShow:"请输入推送平台",onFocus:"请输入推送平台",onCorrect:"输入正确"}).inputValidator({min:1,max:50,onError:"请输入推送平台"});
		$("#uid").formValidator({empty:true,onShow:"请输入目标用户",onFocus:"请输入目标用户",onCorrect:"输入正确"}).inputValidator({min:1,max:11,onError:"请输入目标用户"});
		$("#message_title").formValidator({empty:true,onShow:"请输入消息标题",onFocus:"请输入消息标题",onCorrect:"输入正确"}).inputValidator({min:1,max:50,onError:"请输入消息标题"});
		$("#message_content").formValidator({empty:true,onShow:"请输入消息内容",onFocus:"请输入消息内容",onCorrect:"输入正确"}).inputValidator({min:1,max:500,onError:"请输入消息内容"});
		$("#devices_token").formValidator({empty:true,onShow:"请输入设备编号",onFocus:"请输入设备编号",onCorrect:"输入正确"}).inputValidator({min:1,max:50,onError:"请输入设备编号"});
		$("#message_state").formValidator({empty:true,onShow:"请输入消息状态",onFocus:"请输入消息状态",onCorrect:"输入正确"}).inputValidator({min:1,max:11,onError:"请输入消息状态"});
		$("#receiver_type").formValidator({empty:true,onShow:"请输入发送范围",onFocus:"请输入发送范围",onCorrect:"输入正确"}).inputValidator({min:1,max:11,onError:"请输入发送范围"});
		$("#message_totalnum").formValidator({empty:true,onShow:"请输入共需发送",onFocus:"请输入共需发送",onCorrect:"输入正确"}).inputValidator({min:1,max:11,onError:"请输入共需发送"});
		$("#message_sendnum").formValidator({empty:true,onShow:"请输入总发送数",onFocus:"请输入总发送数",onCorrect:"输入正确"}).inputValidator({min:1,max:11,onError:"请输入总发送数"});
		$("#message_errorcode").formValidator({empty:true,onShow:"请输入错误代码",onFocus:"请输入错误代码",onCorrect:"输入正确"}).inputValidator({min:1,max:50,onError:"请输入错误代码"});
		$("#message_errormsg").formValidator({empty:true,onShow:"请输入错误信息",onFocus:"请输入错误信息",onCorrect:"输入正确"}).inputValidator({min:1,max:50,onError:"请输入错误信息"});
		$("#message_sendtime").formValidator({empty:true,onShow:"请输入发送时间",onFocus:"请输入发送时间",onCorrect:"输入正确"}).inputValidator({min:1,max:10,onError:"请输入发送时间"});
		

	$.formValidator.reloadAutoTip();
});

function reloadAutoTip()
{
	$.formValidator.reloadAutoTip();
}

function load_type_info(obj)
{
	//alert(obj);
	if(obj==4)
	{
		$("#type_4").css("display","block");
		$("#type_3").css("display","none");
	}
	else
	{
		$("#type_3").css("display","block");
		$("#type_4").css("display","none");
	}
	
}

</script>


<!--/dialog_end-->
</td>
</tr>
</table>

</div>

<include file="../public/_footer" />
