<include file="../public/_header" />
<div class="so_main">

  <div class="page_tit">权限设置</div>
  <div class="tit_tab">
	<ul>
		<volist id="r" name="role">
		<li><a <php> if(get("admin_role_id")==$r['admin_role_id']){ echo " class=\"on\" ";}</php> href="?g=shop&m=index&a=admin_role_menu&admin_role_id={$r.admin_role_id}">{$r.admin_role_name}</a></li>
		</volist>
	</ul>
	</div>

  <!--------list -------->
  <div class="Toolbar_inbox">
  	<div class="page right">{$pages}</div>

	<a href="javascript:void(0);" class="btn_a"  onclick="mod_post_batch2('{:U('shop/index/admin_role_menu_action')}','mod_table','<php> echo  get('admin_role_id');</php>');"><span>保存权限</span></a>

	<div class="clear"></div>
  </div>
  <div class="list">
	<php>if($total>0){</php>
	  <table width="100%" id="mod_table" border="0" cellspacing="0" cellpadding="0">
	  <tr>
		<th style="width:88px;">
			<input type="checkbox" id="checkbox_handle" onclick="select_all(this,'mod_table','checkbox')" value="0">
			<label for="checkbox"></label>
		</th>
		<th class="line_l">菜单名称</th>
	</tr>
	<volist id="vo" name="list">
	<tr overstyle="on" id=ids_{$vo["shop_admin_menu_id"]}>
		<td><input type="checkbox" name="checkbox" onclick="select_sub(this)" value="{$vo.shop_admin_menu_id}" id="up_{$vo.shop_admin_menu_id}" class="sub_class_{$vo.shop_admin_menu_id}" <php>if(menu_is_can_shop($vo['shop_admin_menu_id'],get("admin_role_id"))){ echo " checked ";}</php> ></td>
			<td><span style="font-size:14px;">{$vo.shop_admin_menu_name}</span> <span style="font-size:10px; color:#666;">({$vo.shop_admin_menu_id})</span></td>
	</tr>
		<volist name="vo['sub']" id="sub">
		<tr overstyle="on"  id=ids_{$sub["shop_admin_menu_id"]}>
			<td><input type="checkbox" name="checkbox" onclick="select_one(this,{$vo["shop_admin_menu_id"]})" value="{$sub.shop_admin_menu_id}" class="sub_class_{$sub.shop_admin_menu_parent_id}" <php>if(menu_is_can_shop($sub['shop_admin_menu_id'],get("admin_role_id"))){ echo " checked ";}</php ></td>
				<td style="text-indent:20px;"> |-    {$sub.shop_admin_menu_name} <span style="font-size:10px; color:#666;">({$sub.shop_admin_menu_id})</span></td>
		</tr>
		</volist>
		<tr  >
			<td style="height:20px;"></td>
			<td></td>
		</tr>

	</volist>
    </table>
	  <php>}else{</php>
			<div class="no_data">
				<img src="/skin/images/no_data.gif" align="absmiddle"> <span>没有符合条件的权限菜单，请尝试其他搜索条件... </span>
			</div>
	 <php>}</php>
  </div>

  <div class="Toolbar_inbox">
	<div class="page right">{$pages}</div>

	<a href="javascript:void(0);" class="btn_a"  onclick="mod_post_batch2('{:U('shop/index/admin_role_menu_action')}','mod_table','<php> echo  get('admin_role_id');</php>');"><span>保存权限</span></a>


	<div class="clear"></div>
  </div>
</div>

<script>
function select_one(obj,parent_id)
{
	if(obj.checked==true)
	{
		$("#up_"+parent_id).attr("checked","true");
	}
	else
	{
		$("#up_"+parent_id).removeAttr("checked","true");
	}
}

function select_sub(obj)
{
	var class_name=$(obj).attr("class");
	if(obj.checked==true)
	{
		$("."+class_name).attr('checked','true');
	}
	else
	{
		$("."+class_name).removeAttr('checked');
	}
}

	$(document).ready(function(){
		$("tr[overstyle='on']").hover(
		  function ()
		  {
		    $(this).addClass("bg_hover");
		  },
		  function (){
		    $(this).removeClass("bg_hover");
		  }
		);
	});
</script>


<include file="../public/_footer" />